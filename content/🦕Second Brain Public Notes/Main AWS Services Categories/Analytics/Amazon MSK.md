---
tags:
  - cloud/aws
---

![](https://i.imgur.com/RyPg3e7.png)

![](https://i.imgur.com/Y50anNs.png)

![](https://i.imgur.com/TfNCp3h.png)

![](https://i.imgur.com/bsiK4QR.png)


# FAQ
## General

**Q: What is Amazon MSK?**  
<mark style="background: #FF5582A6;">Amazon Managed Streaming for Apache Kafka (Amazon MSK)</mark> is an A<mark style="background: #D2B3FFA6;">WS streaming data service that manages Apache Kafka infrastructure and operations, making it easy for developers and DevOps managers to run Apache Kafka applications and Kafka Connect connectors on AWS, without the need to become experts in operating Apache Kafka</mark>. Amazon MSK operates, maintains, and scales Apache Kafka clusters, provides enterprise-grade security features out of the box, and has built-in AWS integrations that accelerate development of streaming data applications. To get started, you can migrate existing Apache Kafka workloads and Kafka Connect connectors into Amazon MSK, or with a few clicks, you can build new ones from scratch. There are no data transfer charges for in-cluster traffic, and no commitments or upfront payments required. You only pay for the resources that you use.  

**Q: What is Apache Kafka?**  
[Apache Kafka](https://aws.amazon.com/what-is/apache-kafka/) is an open-source, high performance, fault-tolerant, and scalable platform for building real-time streaming data pipelines and applications. Apache Kafka is a streaming data store that decouples applications producing streaming data (producers) into its data store from applications consuming streaming data (consumers) from its data store. Organizations use Apache Kafka as a data source for applications that continuously analyze and react to streaming data. [Learn more about Apache Kafka](https://aws.amazon.com/what-is/apache-kafka/).  

**Q. What is Kafka Connect?**  
Kafka Connect, an open-source component of Apache Kafka, is a framework for connecting Apache Kafka with external systems, such as databases, key-value stores, search indexes, and file systems.  

**Q: What is streaming data?**  
Streaming data is a continuous stream of small records or events (a record or event is typically a few kilobytes) generated by thousands of machines, devices, websites, and applications. Streaming data includes a wide variety of data such as log files generated by customers using your mobile or web applications, ecommerce purchases, in-game player activity, information from social networks, financial trading floors, geospatial services, security logs, metrics, and telemetry from connected devices or instrumentation in data centers. Streaming data services like Amazon MSK and Amazon Kinesis Data Streams make it easy for you to continuously collect, process, and deliver streaming data. [Learn more about streaming data](https://aws.amazon.com/what-is/streaming-data/).  

**Q: What are Apache Kafka’s primary capabilities?**

Apache Kafka has three key capabilities:

- Apache Kafka stores streaming data in a fault-tolerant way, providing a buffer between producers and consumers. It stores events as a continuous series of records and preserves the order in which the records were produced.
- Apache Kafka allows many data producers—e.g. websites, internet of things (IoT) devices, Amazon Elastic Compute Cloud (Amazon EC2) instances—to continuously publish streaming data and categorize it using Apache Kafka topics. Multiple data consumers (e.g. machine learning applications, AWS Lambda functions, or microservices) read from these topics at their own rate, similar to a message queue or enterprise messaging system.
- Data consumers process data from Apache Kafka topics on a first-in-first-out basis, preserving the order data was produced.

**  
Q: What are the key concepts of Apache Kafka?**

Apache Kafka stores records in topics. Data producers write records to topics and consumers read records from topics. Each record in Apache Kafka consists of a key, a value, and a timestamp and sometimes header metadata. Apache Kafka partitions topics and replicates these partitions across multiple nodes called brokers. Apache Kafka runs as a cluster on one or more brokers, and brokers can be located in multiple AWS availability zones to create a highly available cluster. Apache Kafka relies on [Apache ZooKeeper](https://zookeeper.apache.org/) to coordinate cluster tasks and can maintain state for resources interacting with an Apache Kafka cluster.  

**Q: When should I use Apache Kafka?**  
Apache Kafka supports real-time applications that transform, deliver, and react to streaming data, and can be used to build real-time streaming data pipelines that reliably send data between multiple systems or applications.  

**Q: What does Amazon MSK do?**

Amazon MSK makes it easy to get started and run open-source versions of Apache Kafka on AWS with high availability and security. Amazon MSK also offers integrations with AWS services without the operational overhead of running an Apache Kafka cluster. Amazon MSK allows you to use open-source versions of Apache Kafka while the service manages the setup, provisioning, AWS integrations, and on-going maintenance of Apache Kafka clusters.  
  
With a few clicks in the console, you can create an Amazon MSK cluster. From there, Amazon MSK replaces unhealthy brokers, automatically replicates data for high availability, manages Apache ZooKeeper nodes, automatically deploys hardware patches as needed, manages the integrations with AWS services, makes important metrics visible through the console, and supports Apache Kafka version upgrades so you can take advantage of improvements to the open-source version of Apache Kafka.  

**Q: What Apache Kafka versions does Amazon MSK support?**  
For supported Kafka versions, see the [Amazon MSK documentation](https://docs.aws.amazon.com/msk/latest/developerguide/what-is-msk.html).  

**Q: Are Apache Kafka APIs compatible with Amazon MSK?**  
Yes, all data plane and admin APIs are natively supported by Amazon MSK.

**Q: Is the Apache Kafka AdminClient supported by Amazon MSK?**  
Yes.

**Q: Does Amazon MSK support schema registration?  
**Yes, Apache Kafka clients can use the AWS Glue Schema Registry, a serverless feature of AWS Glue, at no additional charge. Visit the Schema Registry [user documentation](https://docs.aws.amazon.com/glue/latest/dg/schema-registry.html) to get started and to learn more.

**Q: How do I get started with M7g clusters?**  
Amazon MSK now supports Graviton 3 based M7g instances from “large” through “16xlarge” sizes to run all Kafka workloads. Graviton instances come with the same availability and durability benefits of MSK, with up to 24% lower costs compared to corresponding M5 instances. Graviton instances provide up to 29% higher throughput per instance compared to MSK’s M5 instances, which enables customers to run MSK clusters with a fewer brokers or smaller sized instances.

## MSK Serverless

**Q: What is MSK Serverless?**  
MSK Serverless is a cluster type for Amazon MSK that makes it easy for you to run Apache Kafka clusters without having to manage compute and storage capacity. With MSK Serverless, you can run your applications without having to provision, configure, or optimize clusters, and you pay for the data volume you stream and retain.

**Q: Does MSK Serverless automatically balance partitions within a cluster?**  
Yes. MSK Serverless fully manages partitions, including monitoring and moving them to even load across a cluster.

**Q: How much data throughput capacity does MSK Serverless support?**  
MSK Serverless provides up to 200 MBps of write capacity and 400 MBps of read capacity per cluster. Additionally, to ensure sufficient throughput availability for all partitions in a cluster, MSK Serverless allocates up to 5 MBps of instant write capacity and 10 MBps of instant read capacity per partition.

**Q: What security features does MSK Serverless offer?**  
MSK Serverless encrypts all traffic in transit and all data at rest using service-managed keys issued through AWS Key Management Service (KMS). Clients connect to MSK Serverless over a private connection using AWS PrivateLink without exposing your traffic to the public internet. Additionally, MSK Serverless offers IAM Access Control, which you can use to manage client authentication and client authorization to Apache Kafka resources such as topics.

**Q: How can producers and consumers access my MSK Serverless clusters?**  
When you create a MSK Serverless cluster, you provide subnets of one or more Amazon Virtual Private Clouds (VPCs) that host the clients of the cluster. Clients hosted in any of these VPCs will be able to connect to the MSK Serverless cluster using its broker bootstrap string.

**Q: Which regions is MSK Serverless available in?**  
Please refer to the [MSK pricing page](https://aws.amazon.com/msk/pricing/) for up-to-date regional availability.

**Q: Which authentication types does MSK Serverless support?**  
MSK Serverless currently supports AWS IAM for client authentication and authorization. Your clients can assume an AWS IAM role for authentication, and you can enforce access control using an associated IAM policy.

**Q: How do I process data in my MSK Serverless cluster?**  
You can use any Apache Kafka compatible tools to process data in your MSK Serverless cluster topics. MSK Serverless integrates with Amazon Managed Service for Apache Flink for stateful stream processing and AWS Lambda for event processing. You can also use Kafka Connect sink connectors to send data to any desired destination.

**Q: How does MSK Serverless ensure high availability?**\When you create a partition, MSK Serverless creates 2 replicas of it and places them in different availability zones. Additionally, MSK serverless automatically detects and recovers failed backend resources to maintain high availability.

## Data Production and Consumption

**Q: Can I use Apache Kafka APIs to get data in and out of Apache Kafka?**  
Yes, Amazon MSK supports the native Apache Kafka producer and consumer APIs. Your application code does not need to change when clients begin to work with clusters within Amazon MSK.  
  
**Q: Can I use Apache Kafka Connect, Apache Kafka Streams, or any other ecosystem component of Apache Kafka with Amazon MSK?**  
Yes, you can use any component that leverages the Apache Kafka producer and consumer APIs, and the Apache Kafka Admin Client. Tools that upload .jar files into Apache Kafka clusters are currently not compatible with Amazon MSK, including Confluent [Control Center](https://www.confluent.io/confluent-control-center/), Confluent [Auto Data Balancer](https://www.confluent.io/product/auto-data-balancing/), and Uber [uReplicator](https://github.com/uber/uReplicator).

## Migrating to Amazon MSK

**Q: Can I migrate data within my existing Apache Kafka cluster to Amazon MSK?**  
Yes, you can use third-party tools or open-source tools like MirrorMaker, supported by Apache Kafka, to replicate data from clusters into an Amazon MSK cluster. Here is an Amazon [MSK migration lab](https://amazonmsk-labs.workshop.aws/en/migration.html) to help you complete a migration.  

## Version Upgrades

**Q: Are Apache Kafka version upgrades supported?**  
Yes, Amazon MSK supports fully managed in-place Apache Kafka version upgrades for provisioned clusters. To learn more about upgrading your Apache Kafka version and high availability best practices, see the [version upgrades documentation](https://docs.aws.amazon.com/msk/latest/developerguide/version-upgrades.html).

## Clusters

**Q: How do I create my first Amazon MSK cluster?**  
You can create your first cluster with a few clicks in the AWS management console or using the AWS SDKs. First, in the [Amazon MSK console](https://console.aws.amazon.com/msk/home?region=us-east-1) select an AWS region to create an Amazon MSK cluster in. Choose a name for your cluster, the Virtual Private Cloud (VPC) you want to run the cluster with, and the subnets for each AZ. If you are creating a provisioned cluster, you will also be able to pick a broker instance type, quantity of brokers per AZ, and storage per broker.

**Q: What resources are within a cluster?**  
Provisioned clusters contain broker instances, provisioned storage, and abstracted Apache ZooKeeper nodes. Serverless clusters are a resource in of themselves, which abstract away all underlying resources.

**Q: What types of broker instances can I provision within an Amazon MSK cluster?**  
For provisioned clusters, you can choose EC2 T3.small or instances within the EC2 M7g and M5 instance families. For serverless clusters, brokers are completely abstracted.

**Q: Does Amazon MSK offer Reserved Instance pricing?**  
No, not at this time.

**Q: Do I need to provision and pay for broker boot volumes?**  
No, each broker you provision includes boot volume storage managed by the Amazon MSK service.

**Q: When I create an Apache Kafka cluster, do the underlying resources (e.g. Amazon EC2 instances) show up in my EC2 console?**  
Some resources, like elastic network interfaces (ENIs), will show up in your Amazon EC2 account. Other Amazon MSK resources will not show up in your EC2 account as these are managed by the Amazon MSK service.

**Q: What do I need to provision within an Amazon MSK cluster?**  
For provisioned clusters, you need to provision broker instances and broker storage with every cluster you create. You may optionally provision storage throughput for storage volumes, which can be used to seamlessly scale I/O without having to provision additional brokers. You do not need to provision Apache ZooKeeper nodes as these resources are included at no additional charge with each cluster you create. For serverless clusters, you just create a cluster as a resource.

**Q: What is the default broker configuration for a cluster?**  
Unless otherwise specified, Amazon MSK uses the same defaults specified by the open-source version of Apache Kafka. The default settings for both cluster types are documented [here](https://docs.aws.amazon.com/msk/latest/developerguide/msk-default-configuration.html).

**Q: Can I provision brokers such that they are imbalanced across AZs (e.g. 3 in us-east-1a, 2 in us-east-1b, 1 in us-east-1c)?**

No, Amazon MSK enforces the best practice of balancing broker quantities across AZs within a cluster.  
  

**Q: How does data replication work in Amazon MSK?**

Amazon MSK uses Apache Kafka’s leader-follower replication to replicate data between brokers. Amazon MSK makes it easy to deploy clusters with multi-AZ replication and gives you the option to use a custom replication strategy by topic. By default with each of the replication options, leader and follower brokers will be deployed and isolated using the replication strategy specified. For example, if you select a three AZ broker replication strategy with 1 broker per AZ cluster, Amazon MSK will create a cluster of three brokers (one broker in three AZs in a region), and by default (unless you choose to override the topic replication factor) the topic replication factor will also be three.  

**Q: Can I change the default broker configurations or upload a cluster configuration to Amazon MSK?**  
Yes, Amazon MSK allows you to create custom configurations and apply them to new and existing clusters. For more information on custom configurations, see the [configuration documentation](https://docs.aws.amazon.com/msk/latest/developerguide/msk-configuration.html).

**Q: What configuration properties am I able to customize?**  
The configurations properties that you can customize are documented [here](https://docs.aws.amazon.com/msk/latest/developerguide/msk-configuration-properties.html).  
  
**Q: What is the default configuration of a new topic?**  
Amazon MSK uses Apache Kafka’s default configuration unless otherwise specified [here](https://docs.aws.amazon.com/msk/latest/developerguide/msk-default-configuration.html).  

## Topics

**Q: How do I create topics?**  
Once your Apache Kafka cluster has been created, you can create topics using the Apache Kafka APIs. All topic and partition level actions and configurations are performed using Apache Kafka APIs. The following command is an example of creating a topic using Apache Kafka APIs and the configuration details available for your cluster:  
  
`bin/kafka-topics.sh --create —bootstrap-server <BootstrapBrokerString> --replication-factor 3 --partitions 1 --topic TopicName`  

## Networking

**Q: Does Amazon MSK run in an Amazon VPC?**  
Yes, Amazon MSK always runs within an Amazon VPC managed by the Amazon MSK service. Amazon MSK resources will be available to your own Amazon VPC, subnet, and security group you select when the cluster is setup. IP addresses from your VPC are attached to your Amazon MSK resources through elastic network interfaces (ENIs), and all network traffic stays within the AWS network and is not accessible to the internet by default.  
  
**Q: How will the brokers in my Amazon MSK cluster be made accessible to clients within my VPC?**  
The brokers in your cluster will be made accessible to clients in your VPC through ENIs appearing in your account. The Security Groups on the ENIs will dictate the source and type of ingress and egress traffic allowed on your brokers.  

**Q: Is it possible to connect to my cluster over the public Internet?**  
Yes, Amazon MSK offers an option to securely connect to the brokers of Amazon MSK clusters running Apache Kafka 2.6.0 or later versions over the internet. By enabling public access, authorized clients external to a private Amazon Virtual Private Cloud (VPC) can stream encrypted data in and out of specific Amazon MSK clusters. You can enable public access for MSK clusters after a cluster has been created at no additional cost, but standard AWS data transfer costs for cluster ingress and egress apply. To learn more about turning on public access, see the [public access documentation](https://docs.aws.amazon.com/msk/latest/developerguide/public-access.html).  

**Q: Is the connection between my clients and an Amazon MSK cluster private?**  
By default, the only way data can be produced and consumed from an Amazon MSK cluster is over a private connection between your clients in your VPC and the Amazon MSK cluster. However, if you turn on public access for your Amazon MSK cluster and connect to your MSK cluster using the public bootstrap-brokers string, the connection, though authenticated, authorized and encrypted, is no longer considered private. We recommend that you configure the cluster's security groups to have inbound TCP rules that allow public access from your trusted IP address and make these rules as restrictive as possible if you turn on public access.  

## Connecting to the VPC

**Question: How do I connect to my Amazon MSK cluster over the internet?**  
The easiest way is to turn on public connectivity over the internet to the brokers of MSK clusters running Apache Kafka 2.6.0 or later versions. For security reasons, you can't turn on public access while creating an MSK cluster. However, you can update an existing cluster to make it publicly accessible. You can also create a new cluster and then update it to make it publicly accessible. To learn more about turning on public access, see the [public access documentation](https://docs.aws.amazon.com/msk/latest/developerguide/public-access.html).

**Question: How do I connect to my Amazon MSK cluster from from inside AWS network but outside the cluster’s Amazon VPC?**  
You can connect to your MSK cluster from any VPC or AWS account different than your MSK cluster’s by turning on the multi-VPC private connectivity for MSK clusters running Apache Kafka versions 2.7.1. or later versions. You can only turn on private connectivity after cluster creation for any of the supported authentication schemes (IAM authentication, SASL SCRAM and mTLS authentication). You should configure your clients to connect privately to the cluster using Amazon MSK managed VPC connections that uses AWS PrivateLink technology to enable private connectivity. To learn more about setting up private connectivity, see [Access from within AWS documentation.](https://docs.aws.amazon.com/msk/latest/developerguide/aws-access-mult-vpc.html)  

## Encryption

**Q: Can I encrypt data in my Amazon MSK cluster?**  
Yes, Amazon MSK uses [Amazon Elastic Block Store (Amazon EBS) server-side encryption](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html) and [AWS Key Management Service (AWS KMS)](https://aws.amazon.com/kms/) keys to encrypt storage volumes.

**Q: Is data encrypted in transit between brokers within an Amazon MSK cluster?**  
Yes, by default new clusters have encryption in-transit enabled via TLS for inter-broker communication. For provisioned clusters, you can opt out of using encryption in transit when a cluster is created.

**Q: Is data encrypted in transit between my Apache Kafka clients and the Amazon MSK service?**  
Yes, by default in-transit encryption is set to TLS only for clusters created from the CLI or AWS Management Console. Additional configuration is required for clients to communicate with clusters using TLS encryption. For provisioned clusters, you can change the default encryption setting by selecting the TLS/plaintext or plaintext settings. Read more about [MSK Encryption](https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html).

**Q: Is data encrypted in transit as it moves between brokers and Apache ZooKeeper nodes in an Amazon MSK cluster?**  
Yes, Amazon MSK clusters running Apache Kafka version 2.5.1 or greater support TLS in-transit encryption between Kafka brokers and ZooKeeper nodes.

## Access Management

**Q: How do I control cluster authentication and Apache Kafka API authorization?**  
For serverless clusters, you can use IAM Access Control for both authentication and authorization. For provisioned clusters, you have three options: 1) [AWS Identity and Access Management (IAM) Access Control](https://docs.aws.amazon.com/msk/latest/developerguide/iam-access-control.html) for both AuthN/Z (recommended), 2) TLS certificate authentication (CA) for AuthN and access control lists for AuthZ, and 3) SASL/SCRAM for AuthN and access control lists for AuthZ. Amazon MSK recommends using IAM Access Control. It is the easiest to use and, because it defaults to least privilege access, the most secure option.  

**Q: How does authorization work in Amazon MSK?**  
If you are using IAM Access Control, Amazon MSK uses the policies you write and its own authorizer to authorize actions. If you are using TLS certificate authentication or SASL/SCRAM, Apache Kafka uses access control lists (ACLs) for authorization. To enable ACLs you must enable client authentication using either TLS certificates or SASL/SCRAM.  

**Q: How can I authenticate and authorize a client at the same time?**  
If you are using IAM Access Control, Amazon MSK will authenticate and authorize for you without any additional set up. If you are using TLS authentication, you can use the Dname of clients TLS certificates as the principal of the ACL to authorize client requests. If you are using SASL/SCRAM, you can use the username as the principal of the ACL to authorize client requests.  

**Q: How do I control service API actions?**  
You can control service API actions using AWS Identity and Access Management (IAM).  

**Q: Can I enable IAM Access Control for an existing cluster?**  
Yes, you can enable IAM Access Control for an existing cluster from the AWS console or by using the UpdateSecurity API.  

**Q: Can I use IAM Access Control outside of Amazon MSK?**  
No, IAM Access Control is only available for Amazon MSK clusters.

**Q: How do I provide cross-account access permissions to a Kafka client in an AWS account different from Amazon MSK’s to connect privately to my Amazon MSK cluster?**  
You can attach a cluster policy to your Amazon MSK cluster to provide your cross-account Kafka client permissions to set up private connectivity to your Amazon MSK cluster. When using IAM client authentication, you can also use the cluster policy to granularly define the Kafka data plane permissions for the connecting client. To learn more about cluster policies, see the cluster [policy documentation.](https://docs.aws.amazon.com/msk/latest/developerguide/aws-access-mult-vpc.html#mvpc-cluster-owner-action-policy)  

## Monitoring, Metrics, Logging, and Tagging

**Q: How do I monitor the performance of my clusters or topics?**  
You can monitor the performance of your clusters using the Amazon MSK console, Amazon CloudWatch console, or via JMX and host metrics using Open Monitoring with Prometheus, an open-source monitoring solution.  
  
**Q: What is the cost for the different CloudWatch monitoring levels?**  
The cost of monitoring your cluster using Amazon CloudWatch is dependent on the monitoring level and the size of your Apache Kafka cluster. Amazon CloudWatch charges per metric per month and includes a free tier; see [Amazon CloudWatch pricing](https://aws.amazon.com/cloudwatch/pricing/) for more information. For details on the number of metrics exposed for each monitoring level, see [Amazon MSK monitoring documentation](https://docs.aws.amazon.com/msk/latest/developerguide/monitoring.html).  
  
**Q: What monitoring tools are compatible with Open Monitoring with Prometheus?**  
Tools that are designed to read from [Prometheus](https://prometheus.io/) exporters are compatible with Open Monitoring, like: [Datadog](https://docs.datadoghq.com/integrations/amazon_msk/), [Lenses](https://docs.lenses.io/install_setup/deployment-options/aws-deployment.html#msk-prometheus-metrics), [New Relic](https://blog.newrelic.com/product-news/monitor-amazon-msk/), [Sumo Logic](https://help.sumologic.com/03Send-Data/Collect-from-Other-Data-Sources/Amazon_MSK_Prometheus_metrics_collection), or a Prometheus server. For details on Open Monitoring, see [Amazon MSK Open Monitoring documentation](https://docs.aws.amazon.com/msk/latest/developerguide/monitoring.html#open-monitoring).  
  
**Q: How do I monitor the health and performance of clients?**  
You can use any client-side monitoring supported by the Apache Kafka version you are using.  
  
**Q: Can I tag Amazon MSK resources?**  
Yes, you can tag Amazon MSK clusters from the AWS Command Line Interface (AWS CLI) or Console.  
  
**Q: How do I monitor consumer lag?**  
Topic-level consumer lag metrics are available as part of the default set of metrics that Amazon MSK publishes to Amazon CloudWatch for all clusters. No additional setup is required to get these metrics. For provisioned clusters, you can also get partition-level consumer lag metrics (partition dimension). To do so, enable enhanced monitoring (PER\_PARTITION\_PER\_TOPIC) on your cluster. Alternatively, you can enable Open Monitoring on your cluster, and use a Prometheus server, to capture partition level metrics from the brokers in your cluster. Consumer lag metrics are available at port 11001, just as other Kafka metrics.  
  
**Q: How much does it cost to publish the consumer lag metric to Amazon CloudWatch?**  
Topic level metrics are included in the default set of Amazon MSK metrics, which are free of charge. Partition level metrics are charged as per Amazon CloudWatch pricing.  
  
**Q: How do I access Apache Kafka broker Logs?**  
You can enable broker log delivery for provisioned clusters. You can deliver broker logs to Amazon CloudWatch Logs, Amazon Simple Storage Service (S3), and Amazon Kinesis Data Firehose. Kinesis Data Firehose supports Amazon OpenSearch Service among other destinations. To learn how to enable this feature, see the Amazon MSK [Logging Documentation](https://docs.aws.amazon.com/msk/latest/developerguide/msk-logging.html). To learn about pricing, refer to [CloudWatch Logs](https://aws.amazon.com/cloudwatch/pricing/) and [Kinesis Data Firehose](https://aws.amazon.com/kinesis/data-firehose/pricing/) pricing pages.  
  
**Q: What is the logging level for broker logs?**  
Amazon MSK provides INFO level logs for all brokers within a provisioned cluster.

  
**Q: How do I access Apache ZooKeeper Logs?**  
You can request Apache ZooKeeper logs through a support ticket.  
  
**Q: Can I log the use of Apache Kafka resource APIs, like create topic?**  
Yes, if you use IAM Access Control, the use of Apache Kafka resource APIs is logged to AWS CloudTrail.  

## Apache ZooKeeper

**Q: What is Apache ZooKeeper?**  
From [https://zookeeper.apache.org](https://zookeeper.apache.org/): “Apache ZooKeeper is a centralized service for maintaining configuration information, naming, providing distributed synchronization, and providing group services. All of these kinds of services are used in some form or another by distributed applications,” including Apache Kafka.

**Q: Does Amazon MSK use Apache ZooKeeper?**  
Yes, Amazon MSK uses Apache ZooKeeper and manages Apache ZooKeeper within each cluster as a part of the Amazon MSK service. Apache ZooKeeper nodes are included with each cluster at no additional cost.  

## Integrations

**Q: What AWS services does Amazon MSK integrate with?**

Amazon MSK integrates with:  

- Amazon S3 using Kinesis Data Firehose for delivering data to Amazon S3 form MSK in a easy and no-code manner.  
    
- [Amazon Virtual Private Cloud (Amazon VPC)](https://aws.amazon.com/vpc/) for network isolation and security
- [Amazon CloudWatch](https://aws.amazon.com/cloudwatch/) for metrics
- [AWS Key Management Service (AWS KMS)](https://aws.amazon.com/kms/) for storage volume encryption
- [Amazon IAM](https://aws.amazon.com/iam/) for authentication and authorization of Apache Kafka and service APIs
- [AWS Lambda](https://aws.amazon.com/blogs/compute/using-amazon-msk-as-an-event-source-for-aws-lambda/) for MSK event sourcing
- [AWS IoT](https://aws.amazon.com/about-aws/whats-new/2020/12/aws-iot-core-adds-the-ability-to-deliver-data-to-apache-kafka-clusters/) for IoT event sourcing
- [AWS Glue Schema](https://aws.amazon.com/about-aws/whats-new/2020/11/control-evolution-data-streams-using-aws-glue-schema-registry/) Registry for controlling the evolution of schemas used by Apache Kafka applications  
    
- [AWS CloudTrail](https://aws.amazon.com/cloudtrail/) for AWS API logs
- [AWS Certificate Manager](https://aws.amazon.com/certificate-manager/) for Private CAs used for client TLS authentication
- [AWS CloudFormation](https://aws.amazon.com/cloudformation/) for describing and provisioning Amazon MSK clusters using code  
    
- [Amazon Managed Service for Apache Flink](https://aws.amazon.com/managed-service-apache-flink/) for fully managed Apache Flink applications that process streaming data  
    
- [Amazon Managed Service for Apache Flink Studio](https://aws.amazon.com/managed-service-apache-flink/studio/) for interactive streaming SQL on Apache Kafka  
    
- [AWS Secrets Manager](https://aws.amazon.com/secrets-manager/) for client credentials used for SASL/SCRAM authentication  
    

Amazon MSK Serverless integrates with:  

- Amazon S3 using Kinesis Data Firehose for delivering data to Amazon S3 form MSK in a easy and no-code manner.  
    
- [Amazon VPC](https://aws.amazon.com/vpc/) for network isolation and security
- [Amazon CloudWatch](https://aws.amazon.com/cloudwatch/) for metrics
- [Amazon IAM](https://aws.amazon.com/iam/) for authentication and authorization of Apache Kafka and service APIs
- [AWS Glue Schema Registry](https://aws.amazon.com/about-aws/whats-new/2020/11/control-evolution-data-streams-using-aws-glue-schema-registry/) for controlling the evolution of schemas used by Apache Kafka applications
- [AWS CloudTrail](https://aws.amazon.com/cloudtrail/) for AWS API logs
- [AWS PrivateLink](https://aws.amazon.com/privatelink/) for private connectivity  
    

## Scaling

**Q: How can I scale up storage in my cluster?**  
You can scale up storage in your provisioned clusters using the AWS Management Console or the AWS CLI. You can also use tiered storage to virtually store unlimited data on your cluster without having to add brokers for storage. In serverless clusters, storage is scaled seamlessly based on your usage.

**Q: How does tiered storage work?  
**Apache Kafka stores data in files called log segments. As each segment is complete, based on the size configured at cluster or topic level, it is copied to the low-cost storage tier. Data is held in performance optimized storage for a specified retention time, or size, and then deleted. There is a separate time and size limit setting for the low-cost storage, which will be longer than the primary storage tier. If clients request data from segments stored in the low-cost tier, the broker will read the data from it and serve the data in the same way as if it is being served from the primary storage.  

  
**Q: How can I automatically expand storage in my cluster?**  
You can create an auto-scaling storage policy using the AWS Management Console or by creating an AWS Application Auto Scaling policy using the AWS CLI or APIs.

  
**Q: Can I scale the number of brokers in an existing cluster?**  
Yes. You can scale out, or increase, the number of brokers for provisioned Amazon MSK clusters.  
  
**Q: Can I scale the broker size in an existing cluster?**  
Yes. You can choose to scale to a smaller or larger broker type on your provisioned Amazon MSK clusters.  
  
**Q: How do I balance partitions across brokers?**  
You can use Cruise Control for automatically rebalancing partitions to manage I/O heat. See the [Cruise Control documentation](https://docs.aws.amazon.com/msk/latest/developerguide/cruise-control.html) for more information. Alternatively, you can use the Kafka Admin API kafka-reassign-partitions.sh to reassign partitions across brokers. In serverless clusters, Amazon MSK automatically balances partitions.  

## Pricing and Availability

**Q: How does Amazon MSK pricing work?**  
Pricing depends on the resources you create. You can learn more by visiting our [pricing page](https://aws.amazon.com/msk/pricing/).

**Q: Do I pay for data transfer as a result of data replication?**  
No, all in-cluster data transfer is included with the service at no additional charge.  
  
**Q: What AWS regions offer Amazon MSK?**  
Amazon MSK region availability is documented [here](https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/). 

**Q: How does data transfer pricing work?**  
With provisioned clusters, you will pay standard AWS data transfer charges for data transferred in and out of an Amazon MSK cluster. You will not be charged for data transfer within the cluster in a region, including data transfer between brokers and data transfer between brokers and Apache ZooKeeper nodes.

With serverless clusters, you will pay standard AWS data transfer charges for data transferred to or from another region and for data transferred out to the public internet.  

## Compliance

**Q: What compliance programs are in scope for Amazon MSK?**

Amazon MSK is compliant or eligible for the following programs:  
  

- HIPAA eligible

- PCI

- ISO

- SOC 1,2,3

For a complete list of AWS services and compliance programs, please see [AWS Services in Scope by Compliance Program](https://aws.amazon.com/compliance/services-in-scope/).  

## Service Level Agreement

**Q: What does the Amazon MSK SLA guarantee?**

Our Amazon MSK SLA guarantees a Monthly Uptime Percentage of at least 99.9% for Amazon MSK (including MSK Serverless and MSK Connect).  

**Q: How do I know if I qualify for a SLA Service Credit?**

You are eligible for a SLA credit for Amazon MSK under the Amazon MSK SLA if Multi-AZ deployments on Amazon MSK have a Monthly Uptime Percentage of less than 99.9% during any monthly billing cycle.

For full details on all of the terms and conditions of the SLA, as well as details on how to submit a claim, please see the [Amazon MSK SLA details page](https://aws.amazon.com/msk/sla/).  

## Replication

**Q: What is Amazon MSK Replicator?**  
[Amazon MSK Replicator](https://aws.amazon.com/msk/features/msk-replicator/) is a feature of Amazon MSK that enables customers to reliably replicate data across Amazon MSK clusters in different AWS regions (cross-region replication) or within the same AWS region (same-region replication), without writing code or managing infrastructure. You can use cross-region replication (CRR) to build highly available and fault-tolerant multi-region streaming applications for increased resiliency. You can also CRR to provide lower latency access to consumers in different geographic regions. You can use SRR to distribute data from one cluster to many clusters for sharing data with your partners and teams. You can also use SRR to aggregate data from multiple clusters into one for analytics.

**Q: How do I use MSK Replicator?**  
To setup replication between a pair of source and target MSK clusters, you need to create a Replicator in the destination AWS region. To create a Replicator, you specify details that include the Amazon Resource Name (ARN) of the source and target MSK clusters and an AWS Identity and Access Management (IAM) role that MSK Replicator can use to access the clusters. You will need to create the target MSK cluster if it does not already exist.

**Q: Which type of Kafka clusters are supported by MSK Replicator?**  
MSK Replicator supports replication across MSK clusters only. Both Provisioned and Serverless type of MSK clusters are supported. You can also use MSK Replicator to move from Provisioned to Serverless or vice-versa. Other Kafka clusters are not supported.

**Q: Can I specify which topics I want to replicate?**  
Yes, you can specify which topics you want to replicate using allow and deny lists while creating the Replicator.

**Q: Does MSK Replicator replicate topic settings and consumer group offsets?**  
Yes. MSK Replicator automatically replicates the necessary Kafka metadata like topic configuration, Access Control Lists (ACLs), and consumer group offsets so that consuming applications can resume processing seamlessly after failover. You can choose to turn off one or more of these settings if you only want to replicate the data. You can also specify which consumer groups you want to replicate using allow or deny lists while creating the Replicator.

**Q: Do I need to scale the replication when my ingress throughput changes?**  
No, MSK Replicator automatically deploys, provisions and scales the underlying replication infrastructure to support changes in your ingress throughput.

**Q: Can I replicate data across MSK clusters in different AWS accountS?**  
No, MSK Replicator only supports replication across MSK clusters in the same AWS account.

**Q: How can I monitor the replication?**  
You can use Amazon CloudWatch in the destination region to view metrics for “ReplicationLatency,  
MessageLag, and ReplicatorThroughput” at a topic and aggregate level for each Replicator at no additional charge. Metrics would be visible under ReplicatorName in “AWS/Kafka” namespace. You can also see the “ReplicatorFailure, AuthError and ThrottleTime” metrics to check if your Replicator is running into any issues.

**Q: How can I use replication to increase the resiliency of my streaming application across regions?**  
You can use MSK Replicator to setup active-active or active-passive cluster topologies to increase resiliency of your Kafka application across regions. In an active-active setup, both MSK clusters are actively serving reads and writes. Comparatively, in an active-passive setup only one MSK cluster at a time is actively serving streaming data, while the other cluster is on standby.

**Q: Can I use MSK Replicator to replicate data from one cluster to multiple clusters or replicate data from many clusters to one?**  
Yes. You simply need to create a different Replicator for each source and target cluster pair.

**Q: How does MSK Replicator connect to the source and target MSK clusters?**  
MSK Replicator uses IAM Access Control to connect to your source and target clusters. You need to turn on your source and target MSK clusters for IAM Access Control for creating a Replicator. You can continue to use other authentication methods including SASL/SCRAM and mTLS at the same time for your clients since Amazon MSK supports multiple authentication methods simultaneously.

**Q: How much replication latency should I expect with MSK Replicator?**  
MSK Replicator replicates data asynchronously. Replication latency varies based on many factors including the network distance between the AWS regions of your MSK clusters, your source and target clusters’ throughput capacity and the number of partitions on your source and target clusters

**Q: Can I keep topic names same with MSK Replicator?**  
No, MSK Replicator creates new topics in the target cluster with an auto-generated prefix added to the topic name. For instance, MSK Replicator will replicate data in “topic” from the source cluster to a new topic in target cluster called `<sourceKafkaClusterAlias>.topic`. MSK Replicator does this to distinguish topics that contain data replicated from source cluster from other topics in the target cluster and avoid data being circularly replicated between the clusters. You can find the prefix that will be added to the topic names in the target cluster under “sourceKafkaClusterAlias“ field using DescribeReplicator API or the Replicator details page on the MSK Console.

**Q: Can I replicate existing data on the source cluster?**  
No. When you create a new Replicator, it starts replicating data from the tip of the stream (latest offset) on the source cluster.

**Q: Can replication result in throttling consumers on the source cluster?**  
Since MSK Replicator acts as a consumer for your source cluster, it is possible that replication causes other consumers to be throttled on your source cluster. This depends on how much read capacity you have on your source cluster and throughput of the data you are replicating. We recommend that your provision identical capacity for your source and target clusters and account for the replication throughput while calculating how much capacity you need. You can also set Kafka quotas for the Replicator on your source and target clusters to control how much capacity the Replicator can use.

**Q: Can I compress data before writing to the target cluster?**  
Yes, you can specify your choice of compression codec while creating the Replicator amongst None, GZIP, Snappy, LZ4 and ZSTD.